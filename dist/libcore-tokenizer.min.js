!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define("libcore-tokenizer",[],n):"object"==typeof exports?exports["libcore-tokenizer"]=n():t["libcore-tokenizer"]=n()}(this,function(){return function(t){function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}var e={};return n.m=t,n.c=e,n.i=function(t){return t},n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},n.p="/assets/",n(n.s=21)}([function(t,n,e){"use strict";function r(t){return y.call(t)}function i(t){return null===t?"[object Null]":void 0===t?"[object Undefined]":y.call(t)}function o(t,n){return j(t)===n}function a(t){return y.call(t)===x}function c(t){return null!==t&&void 0!==t&&y.call(t)===x}function s(t){var n,e,r=w;return j(t)===x&&(n=t.constructor,r.hasOwnProperty.call(t,"constructor")?(delete t.constructor,e=t.constructor===r,t.constructor=n,e):n===r)}function u(t,n){return"string"==typeof t&&(!0===n||0!==t.length)}function l(t){return"number"==typeof t&&isFinite(t)}function f(t){switch(typeof t){case"number":return isFinite(t);case"boolean":case"string":return!0}return!1}function h(t){return"[object Function]"===y.call(t)}function g(t){return"[object Array]"===y.call(t)}function p(t){return"[object Date]"===y.call(t)}function d(t){return"[object RegExp]"===y.call(t)}var v=e(3),b=v.validSignature,x="[object Object]",w=Object,m=w.prototype,y=m.toString,j=b?r:i;t.exports={signature:j,object:b?a:c,nativeObject:s,string:u,number:l,scalar:f,array:g,method:h,date:p,regex:d,type:o}},function(t,n,e){"use strict";function r(){}function i(t,n,e){var r=o,i=u;return e&&i(e,r,t),i(n,r,t),t}function o(t,n){this[n]=t}function a(t,n,e){var r=[t,n];return u(e,c,r),r=r[0]=r[1]=null,t}function c(t,n){var e=this;e[0][n]=e[1][t],e=null}function s(t,n,e){var r=o,i=u;return e&&i(e,r,t,!1),i(n,r,t),t}function u(t,n,e,r){var i,o=A,a=!1===r;void 0===e&&(e=null);for(i in t)if((a||o.call(t,i))&&!1===n.call(e,t[i],i,t))break;return t}function l(t,n){return A.call(t,n)}function f(t){return u(t,h,null,!0),t}function h(){delete arguments[2][arguments[1]]}function g(t,n,e){return u(n,p,t,e),t}function p(t,n){var e=this;l(e,n)||(e[n]=t),e=null}function d(t,n,e,r){var o,a,c,s,u,f,h,g=O.jsonPath(n),p=k,d=p.object,v=p.array,b=l,x=i,w=I,m=t,y=n;if(g)for(y=g[0],g.splice(0,1),c=-1,s=g.length;s--;)a=g[++c],o=w.test(a),b(m,y)?(u=m[y],h=v(u),h||d(u)?h&&!o&&(u=x({},u),delete u.length):o?u=[u]:(f=u,u={},u[""]=f)):u=o?[]:{},m=m[y]=u,a||(v(m)?a=m.length:0 in m&&(a="0")),y=a;return!0!==r&&b(m,y)&&(u=m[y],v(u)?(m=u,y=m.length):(m=m[y]=[u],y=1)),m[y]=e,m=e=u=f=null,t}function v(t,n){return r.prototype=t.prototype,k.object(n)?i(new r,n):new r}function b(t,n){return x(t,n,[])}function x(t,n,e){var r,i,o=k,a=o.object,c=o.array,s=o.regex,u=o.date,l=x,f=e.length;switch(!0){case t===n:return!0;case a(t):if(!a(n))return!1;if(-1!==e.lastIndexOf(t)&&-1!==e.lastIndexOf(n))return!0;e[f]=t,e[f+1]=n;for(r in t)if(!(r in n&&l(t[r],n[r],e)))return!1;for(r in n)if(!(r in t&&l(t[r],n[r],e)))return!1;return e.length=f,!0;case c(t):if(!c(n))return!1;if(-1!==e.lastIndexOf(t)&&-1!==e.lastIndexOf(n))return!0;if((i=t.length)!==n.length)return!1;for(e[f]=t,e[f+1]=n;i--;)if(!l(t[i],n[i],e))return!1;return e.length=f,!0;case s(t):return s(n)&&t.source===n.source;case u(t):return u(n)&&t.toString()===n.toString()}return!1}function w(t,n){var e=k,r=e.nativeObject(t);return n=!0===n,r||e.array(t)?n?(r?m:y)(t,[],[]):r?s({},t):t.slice(0):e.regex(t)?new RegExp(t.source,t.flags):e.date(t)?new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()):t}function m(t,n,e){var r,i,o,a,c=n.length,s=k,u=s.nativeObject,l=s.array,f=y,h=m,g={};n[c]=t,e[c]=g;for(r in t)i=t[r],a=u(i),a||l(i)?(o=n.lastIndexOf(i),i=-1===o?(a?h:f)(i,n,e):e[o]):i=w(i,!1),g[r]=i;return n.length=e.length=c,g}function y(t,n,e){var r,i,o,a=n.length,c=k,s=c.nativeObject,u=c.array,l=y,f=m,h=[],g=0,p=t.length;for(n[a]=t,e[a]=h;p--;g++)r=t[g],o=s(r),o||u(r)?(i=n.lastIndexOf(r),r=-1===i?(o?f:l)(r,n,e):e[i]):r=w(r,!1),h[g]=r;return n.length=e.length=a,h}var j=Object.prototype,k=e(0),O=e(6),A=j.hasOwnProperty,I=/^[0-9]*$/;t.exports={each:u,assign:i,rehash:a,contains:l,instantiate:v,clone:w,compare:b,fillin:g,urlFill:d,clear:f}},function(t,n,e){"use strict";t.exports=e(11)},function(t,n,e){"use strict";(function(n){function e(){}var r,i,o=n,a=o.document,c=o.window,s=Object.prototype.toString,u=!!a&&!!c&&c.self===(a.defaultView||a.parentWindow),l=!u&&function(){return"process"in n&&n.process.versions||!1}(),f={},h=["log","info","warn","error","assert"],g={browser:u,nodejs:l&&!!l.node,userAgent:u?o.navigator.userAgent:l?function(){var t="process"in n?n.process:null,e=l;return["Node ",e.node,"(",t.platform,"; V8 ",e.v8||"unknown","; arch ",t.arch,")"].join("")}():"Unknown",validSignature:"[object Object]"!==s.call(null)||"[object Object]"!==s.call(void 0),ajax:o.XMLHttpRequest,indexOfSupport:"indexOf"in Array.prototype};if(!o.console)for(r=0,i=h.length;i--;r++)f[h[r]]=e;t.exports=g,o=c=a=null}).call(n,e(4))},function(t,n){var e;e=function(){return this}();try{e=e||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(e=window)}t.exports=e},function(t,n,e){"use strict";(function(n){function r(t,n){var e,r,i=c(t),o=m;return i&&n instanceof Function&&(t=i[1],e=":"+t,e in o||(o[e]={name:t,before:[],after:[]}),r=o[e][a(i[0])],r[r.length]=n),k.chain}function i(t,n,e){var r,i,a=o(t);if(a)for(void 0===e&&(e=null),n instanceof Array||(n=[]),r=-1,i=a.length;i--;)a[++r].apply(e,n);return k.chain}function o(t){var n,e=m,r=c(t);if(r&&(n=":"+r[1])in e)return e[n][a(r[0])]}function a(t){return t===x?"before":"after"}function c(t){var n,e,r=d.string(t)&&t.match(b);if(r)return e=r[1],n="before"===r[4]?x:w,[n,(e||"")+r[5]]}function s(t){var n,e,r,i=y;if(d.string(t))return n=t+".",n in i||(r=u(n),e=l(n),i[n]=e.chain=r.chain={run:r,register:e}),i[n]}function u(t){function n(e,r,o){return i(t+e,r,o),n.chain}return n}function l(t){function n(e,i){return r(t+e,i),n.chain}return n}function f(t){return v.setTimeout(t,1)}function h(t){return v.clearTimeout(t)}function g(t){return v.setImmediate(t)}function p(t){return v.clearImmediate(t)}var d=e(0),v=n,b=/^(([^\.]+\.)*)((before|after)\:)?([a-zA-Z0-9\_\-\.]+)$/,x=1,w=2,m={},y={},j=!!v.setImmediate,k={register:r,run:i,middleware:s,setAsync:j?g:f,clearAsync:j?p:h};t.exports=k.chain=k}).call(n,e(4))},function(t,n,e){"use strict";function r(t){var n,e,r,i,a,c=v,s=[],u=0,l=-1,f=!1,h=c.charAt(64);for(t=o(t),n=t.length;n--;){switch(e=t.charCodeAt(++l),r=l%3){case 0:a=c.charAt((252&e)>>2),f=(3&e)<<4;break;case 1:a=c.charAt(f|(240&e)>>4),f=(15&e)<<2;break;case 2:a=c.charAt(f|(192&e)>>6),f=63&e}if(s[u++]=a,i=!n,(i||2===r)&&(s[u++]=c.charAt(f)),!n){for(n=u%4,n=n&&4-n;n--;)s[u++]=h;break}}return s.join("")}function i(t){var n,e,r,i,o,c=v,s=p,u=[],l=0,f=-1,h=d;for(t=t.replace(b,""),n=t.length;n--;){switch(e=c.indexOf(t.charAt(++f)),o=f%4){case 0:i=0;break;case 1:i=(r<<2|e>>4)&s;break;case 2:i=(r<<4|e>>2)&s;break;case 3:i=(r<<6|e)&s}if(r=e,!n&&o<3&&i<64)break;o&&(u[l++]=h(i))}return a(u.join(""))}function o(t){for(var n,e=h,r=g,i=d,o=[],a=0,c=-1,s=t.length;s--;)n=t.charCodeAt(++c),n<e?o[a++]=i(n):n<2048?(o[a++]=i(192|n>>6),o[a++]=i(e|n&r)):n<55296||n>57343?(o[a++]=i(224|n>>12),o[a++]=i(e|n>>6&r),o[a++]=i(e|n&r)):(s--,n=65536+((1023&n)<<10|1023&t.charCodeAt(++c)),o[a++]=i(240|n>>18),o[a++]=i(e|n>>12&r),o[a++]=i(e|n>>6&r),o[a++]=i(e|n>>r));return o.join("")}function a(t){for(var n,e,r=h,i=g,o=d,a=[],c=Math,s=c.min,u=c.max,l=0,f=t.length,p=-1;f--;)n=t.charCodeAt(++p),n<r?a[l++]=o(n):n>191&&n<224?(a[l++]=o((31&n)<<6|t.charCodeAt(p+1)&i),e=u(s(f-1,1),0),p+=e,f-=e):n>223&&n<240?(a[l++]=o((15&n)<<12|(t.charCodeAt(p+1)&i)<<6|t.charCodeAt(p+2)&i),e=u(s(f-2,2),0),p+=e,f-=e):(n=((7&n)<<18|(t.charCodeAt(p+1)&i)<<12|(t.charCodeAt(p+2)&i)<<6|t.charCodeAt(p+3)&i)-65536,a[l++]=o(n>>10|55296,1023&n|56320),e=u(s(f-3,3),0),p+=e,f-=e);return a.join("")}function c(t){var n,e,r,i,o=[],a=0,c=[],s=a,u=!1,l=!1;for(n=-1,e=t.length;e--;){if(r=t.charAt(++n),i=!e,"["===r){if(u)break;u=!0,s&&(l=!0)}else if("]"===r){if(!u)break;u=!1,l=!0}else c[s++]=r,i&&(l=!0);if(l&&(o[a++]=c.join(""),c.length=s=0,l=!1),i){if(u||a<1)break;return o}}return null}function s(t){return t.replace(x,u)}function u(t){return t.charAt(t.length-1).toUpperCase()}function l(t){return t.replace(w,f)}function f(t){return"-"+t.charAt(t.length-1).toLowerCase()}var h=128,g=63,p=255,d=String.fromCharCode,v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",b=/[^a-zA-Z0-9\+\/]/,x=/[^a-z]+[a-z]/gi,w=/\-*[A-Z]/g;t.exports={encode64:r,decode64:i,utf2bin:o,bin2utf:a,jsonPath:c,camelize:s,uncamelize:l}},function(t,n,e){"use strict";function r(){}t.exports={clone:function(t){return r.prototype=t,new r}}},function(t,n,e){"use strict";function r(t){var n={};t="string"==typeof t?t:"start",n[t]={not:[]},this.stateGenId=0,this.start=t,this.states=n,this.ends={}}var i=e(2);r.prototype={constructor:r,generateState:function(t){return i.string(t)?t:"s"+ ++this.stateGenId},finalizeFragments:function(t,n,e){var r,i,o,a,c,s,u,l,f,h,g,p,d,v,b=this.states,x=this.ends,w={},m={},y=[n],j=1;for(m[n.state.id]=this.start;j--;){o=y[0],y.splice(0,1),r=m[o.state.id],r in b||(b[r]={not:[]}),i=b[r];for(a=o.pointer;a;a=a.next)if(c=a.chr,s=a.to,f=s.id,f in w||(w[f]=!0,y[j++]=s),r=s.state.id,r in m||(m[r]=this.generateState()),r=m[r],a.negative){for(p=i.not,g=d=p.length,h=null;g--&&(h=p[g],h[0]!==r);)h=null;h||(h=p[d++]=[r,{}]),v=h[1],c in v||(v[c]=1)}else c in i||(i[c]=[]),u=i[c],-1===u.indexOf(r)&&(u[u.length]=r)}for(l=e.length;l--;)x[m[e[l]]]=t},importDefinition:function(t){var n,e=i,r=e.object,o=e.string;if(o(t))try{t=JSON.parse(t)}catch(t){throw console.warn(t),new Error("Invalid JSON string parameter.")}if(!r(t))throw new Error("Invalid JSON object parameter.");if(n=t.stateGenId,!e.number(n)||n<0)throw new Error("Invalid state generator");if(this.stateGenId=n,n=t.start,!e.string(n))throw new Error("Invalid start state name");if(this.start=n,n=t.states,!r(n))throw new Error("Invalid state map object");if(this.states=n,n=t.ends,!r(n))throw new Error("Invalid end states object");return this.ends=n,this},exportDefinition:function(){return{stateGenId:this.stateGenId,start:this.start,states:this.states,ends:this.ends}}},t.exports=r},function(t,n,e){"use strict";t.exports=e(20)},function(t,n,e){"use strict";function r(t){for(var n=this,e=n.length,r=-1;e--;)if(t===n[++r])return n=null,r;return-1}function i(t){for(var n=this,e=n.length;e--;)if(t===n[e])return n=null,e;return-1}function o(t,n,e){var r,i,o,a;t=!1!==e?t:t.slice(0),t.push.apply(t,n),a=t.length;t:for(i=a;i--;)for(r=t[i],o=a;o--;)if(i!==o&&r===t[o]){a--,t.splice(i,1);continue t}return t}function a(t,n,e){var r,i,o,a=t.length,c=n.length;t=!1!==e?t:t.slice(0);t:for(i=a;i--;){r=t[i];n:for(o=c;o--;)if(r===n[o]){for(o=a;o--;)if(o!==i&&r===t[o])break n;continue t}t.splice(i,1),a--}return t}function c(t,n,e){var r,i,o,a=t.length,c=n.length;t=!1!==e?t:t.slice(0);t:for(i=a;i--;){for(r=t[i],o=c;o--;)if(r===n[o]){t.splice(i,1),a--;continue t}for(o=a;o--;)if(o!==i&&r===t[o]){t.splice(i,1),a--;continue t}}return t}var s=e(3),u=e(1),l=Array.prototype;s.indexOfSupport||u.assign(l,{indexOf:r,lastIndexOf:i}),t.exports={unionList:o,intersectList:a,differenceList:c}},function(t,n,e){"use strict";var r=e(3),i=e(1),o=e(5),a={env:r};i.assign(a,e(0)),i.assign(a,i),i.assign(a,e(10)),i.assign(a,e(6)),i.assign(a,o),i.assign(a,e(14)),i.assign(a,e(12)),o.chain=a,a.Promise=e(13),a.default=a,t.exports=a},function(t,n,e){"use strict";function r(t,n,e,r,i,o){var a,c,s,u,l,f=[],h=0;for(a=-1,c=t.length;c--;){switch(s=t.charAt(++a),u=!1,l=!c,s){case"\\":s="",c&&(s=t.charAt(++a),c--);break;case".":s="",u=!0}if(s&&(f[h++]=s),(l||u)&&h){if(!1===n(f.join(""),l,e,r,i,o))return;f.length=h=0}}}function i(t,n){var e=g;switch(!0){case e.object(t):case e.array(t)&&(!d.test(n)||"length"!==n):if(!p.contains(t,n))return!1}return!0}function o(t,n,e){var r=e[1];return i(r,t)?(e[n?0:1]=r[t],!0):(e[0]=void 0,!1)}function a(t,n){var e=[void 0,n];return r(t,o,e),e[1]=null,e[0]}function c(t,n,e){return p.clone(a(t,n),e)}function s(t,n,e){e[e.length]=t}function u(t,n,e,i){var o,a,c,u,l,f,h,v,b,x=g,w=p.contains,m=x.array,y=x.object,j=x.assign,k=n,O=d;if((y(k)||m(k))&&(r(t,s,o=[]),o.length)){for(l=o[0],o.splice(0,1),a=-1,c=o.length;c--;)u=o[++a],f=O.test(u),w(k,l)?(h=k[l],v=m(h),v||y(h)?v&&!f&&(h=j({},h),delete h.length):f?h=[h]:(b=h,h={},h[""]=b)):h=f?[]:{},k=k[l]=h,l=u;return!0!==i&&w(k,l)&&(h=k[l],m(h)?(k=h,l=k.length):(k=k[l]=[h],l=1)),k[l]=e,k=e=h=b=null,!0}return!1}function l(t,n,e){var r,o=e[0];if(!i(o,t))return!1;n?(g.array(o)?(r="length"===t,o.splice(r?0:t.toString(10),r?o.length:1)):delete o[t],e[1]=!0):e[0]=o[t]}function f(t,n){var e=[n,!1];return r(t,l,e),e[0]=null,e[1]}function h(t,n,e){return p.compare(a(t,n),n,e)}var g=e(0),p=e(1),d=/^([1-9][0-9]*|0)$/;t.exports={jsonFind:a,jsonCompare:h,jsonClone:c,jsonEach:r,jsonSet:u,jsonUnset:f}},function(t,n,e){"use strict";(function(n){function r(t){var n=h;return n.object(t)&&"then"in t&&n.method(t.then)}function i(t){var n=c;return t instanceof n||(t=g.instantiate(n)),t.__state=[null,void 0,[],null,null],t}function o(t,n){function e(t){try{n(!0,t)}catch(t){n(!1,t)}}r(t)?t.then(e,function(t){n(!1,t)}):e(t)}function a(t,n,e){var r=t.__state,i=r[w];for(r[b]=n,r[x]=e;i.length;)i[0](n,e),i.splice(0,1)}function c(t){function n(t,n){a(c,t,n)}function e(t){s||(s=!0,o(t,n))}function r(t){s||(s=!0,n(!1,t))}var c=i(this),s=!1;try{t(e,r)}catch(t){r(t)}return c}function s(t){return new c(function(n){n(t)})}function u(t){return new c(function(){arguments[1](t)})}function l(t){var n;return t=d.call(t,0),n=t.length,n?new c(function(e,r){var i=t,a=n,c=!1,s=a,u=0,l=[];for(l.length=s;s--;u++)!function(t,n){function i(n,i){var o=l;if(!c){if(!n)return r(i),void(c=!0);o[t]=i,--a||e(o)}}o(n,i)}(u,i[u])}):s([])}function f(t){return t=d.call(t,0),new c(function(n,e){function r(t,r){i||(i=!0,(t?n:e)(r))}for(var i=!1,a=o,c=t,s=-1,u=c.length;u--;)a(c[++s],r)})}var h=e(0),g=e(1),p=e(5),d=Array.prototype.slice,v=n,b=0,x=1,w=2;c.prototype={constructor:c,then:function(t,n){function e(e,r){var i=e?t:n;if(h.method(i))try{return r=i(r),void o(r,function(t,n){a(l,t,n)})}catch(t){r=t,e=!1}a(l,e,r)}var r=this,c=r.__state,s=c[b],u=c[w],l=i();return null===s?u[u.length]=e:p.setAsync(function(){e(s,c[x])}),l},catch:function(t){return this.then(null,t)}},g.assign(c,{all:l,race:f,reject:u,resolve:s}),h.method(v.Promise)||(v.Promise=c),t.exports=c,v=null}).call(n,e(4))},function(t,n,e){"use strict";function r(){return new i}function i(){this.data={}}var o=e(0),a=e(1);i.prototype={constructor:i,get:function(t){var n=this.data;if(a.contains(n,t))return n[t]},set:function(t,n){var e=this.data;return(o.string(t)||o.number(t))&&(e[t]=n),this},unset:function(t){var n=this.data;return a.contains(n,t)&&delete n[t],this},exists:function(t){return a.contains(this.data,t)},clear:function(){return a.clear(this.data),this},clone:function(){var t=this.data;return a.clone(t,!0)}},t.exports={createRegistry:r}},function(t,n,e){"use strict";function r(t,n){if(this.id="f"+ ++t.fgen,this.state={id:null},this.builder=t,n){for(this.pointer=n;n.next;n=n.next);this.lastPointer=n,this.outgoing=this.lastOutgoing={fragment:this,next:null}}}var i=e(7);r.prototype={constructor:r,id:null,state:null,base:null,map:null,splitted:null,repeated:null,pointer:null,lastPointer:null,outgoing:null,lastOutgoing:null,link:function(t){var n,e,r,i,o,a,c,s=this,u=s.outgoing,l=s.splitted,f=t.splitted,h=s.repeated;for(t.applyState();u;u=u.next)u.fragment.pointer.point(t);if(h){for(e=t.lastPointer;h;h=h.next)n=h.pointer,e?e.next=n:t.pointer=n,e=n;t.lastPointer=e}if(i=t.pointer,l&&i){for(o=a=null;l;l=l.next)r=l.fragment,n=i.clone(),e=r.lastPointer.last(),e.next=n[0],r.lastPointer=n[1],r.pointer!==s.pointer&&(c={fragment:r,next:null},o?a.next=c:o=c,a=c);a&&(a.next=f,f=o)}return r=s.clone(),r.splitted=f,r.repeated=t.repeated,r.outgoing=t.outgoing,r.lastOutgoing=t.lastOutgoing,r},lastSplit:function(){var t=this.splitted;if(t){for(;t.next;t=t.next);return t}return null},clone:function(){var t=this.base,n=i.clone(this);return t||(n.base=this),n.id="f"+ ++this.builder.fgen,n},split:function(t){var n=this,e=n.splitted,r={fragment:n,next:null},i=n.clone();return t&&i.repeat(),e||(i.splitted=r),i},repeat:function(){var t=this,n=t.pointer;return!t.repeated&&n&&(n=n.clone(),t.repeated={pointer:n[0],next:null}),t},fill:function(t){var n,e=this,r=e.pointer.range(t.pointer);return r?(t.state=e.state,r?r[1].next=t.pointer:r=[t.pointer],e.lastPointer.next=r[0],n=e.clone(),n.lastPointer=t.lastPointer,n.outgoing.next=t.outgoing,n.lastOutgoing=t.lastOutgoing,n):this.merge(t)},merge:function(t){var n,e,r,i=this,o=i.clone();if(t.state=i.state,i.lastPointer.next=t.pointer,i.lastOutgoing.next=t.outgoing,o.lastPointer=t.lastPointer,o.lastOutgoing=t.lastOutgoing,e=i.splitted,n=t.splitted,o.splitted=e||n,e&&n){for(r=e;r.next;r=r.next);r.next=n}if(e=i.repeated,n=t.repeated,o.repeated=e||n,e&&n){for(r=e;r.next;r=r.next);r.next=n}return o},applyState:function(){var t=this.state;return t.id||(t.id="s"+ ++this.builder.gen),t}},t.exports=r},function(t,n,e){"use strict";function r(t){var n,e,r,f,g,p,d,v,b,x,w,m,y=i,j=l,k=o,O=a,A=c,I=s,S=u,C=0,P=0,E=null,$=[],z=0,F=null,_=[null,"("],M=h,N=[],D=0,G=0;for(r=y(C,t);r;r=y(C,t)){if(C=r[2],e=r[1],n=r[0],d=!1,w=_&&_[1],w&&(m=M[w],n in m&&(n=m[n])),n in j)switch(n){case"(":case"[":case"[^":d=!!F}else switch(F){case"char":case"]":case"]^":case")":case"+":case"?":case"*":case"range":d=!0}if(d&&(N[D++]=["["===w?",":"[^"===w?"^,":".",null,2,P,0]),"[^"===w)switch(n){case"-":n="^-";break;case"]":n="]^";break;case"char":n="negative_char"}for(N[D++]=[n,e,0,P,C-P],P=C,F=n,f=D-G;f--;G++)if(r=N[G],n=r[0],e=r[1],n in j)switch(g=j[n],b=g[0],v=g[1],b){case S:case I:case A:r[2]=b===A?2:1;t:for(;E;E=E[0]){switch(p=E[1],p[0]){case I:case A:if(v<=p[1]){$[z++]=E[2];continue t}}break}b!==S?E=[E,g,r]:$[z++]=r;break;case k:E=[E,g,r],_=[_,n];break;case O:for(;E;E=E[0]){if(p=E[1],p[0]===k){if(p[2]!==n)throw new Error("Unmatched token found "+e);x=E[2][3],$[z++]=[g[2],null,1,x,r[3]-x+1],_&&(_=_[0]),E=E[0];break}$[z++]=E[2]}}else $[z++]=r}if(E)throw new Error("Invalid token found "+E[2][1]);return $}var i=e(19),o=2,a=3,c=4,s=5,u=6,l={"[":[o,15,"]"],"[^":[o,15,"]^"],"]":[a,1,"[]"],"]^":[a,1,"[^]"],"(":[o,15,")"],")":[a,1,"()"],"?":[s,10],"+":[s,10],"*":[s,10],range:[s,10],"-":[c,7],"^-":[c,7],"^,":[c,5],",":[c,5],".":[c,5],"|":[c,3],$$:[u,1]},f={"[":"char","[^":"char","?":"char","+":"char","*":"char",",":"char","|":"char","(":"char",")":"char"},h={"[":f,"[^":f,"(":{"-":"char"}};t.exports=r},function(t,n,e){"use strict";function r(t,n){t&&(this.chr=t),this.negative=!0===n}var i=e(7),o=e(2);r.prototype={constructor:r,negative:!1,repeated:!1,chr:"",to:null,next:null,clone:function(t){var n,e,r=this,a=null,c=i.clone,s=o.assign,u=!1!==t;for(t||(t=null);r&&(n=c(r),t&&s(n,t),a?e.next=n:a=n,e=n,u);r=r.next);return e.next=null,[a,e]},point:function(t){for(var n=this;n;n=n.next)n.to||(n.to=t);return this},last:function(){for(var t=this;t.next;t=t.next);return t},range:function(t){var n,e,i,o=this.chr,a=r,c=String,s=null,u=null,l=this.negative;if(n=o.charCodeAt(0),o=t.chr,t=o.charCodeAt(0),e=Math.max(t-n-1,0)){for(;e--;)i=new a(c.fromCharCode(++n),l),s?u.next=i:s=i,u=i;return s&&[s,u]}return null}},t.exports=r},function(t,n,e){"use strict";function r(t,n,e){var r,s,u,l,f,h,g,p=a,d=c,v=i(n),b=-1,x=v.length,w=null,m=null,y=0,j=[],k=t+" = /"+n+"/",O={gen:0,fgen:0};for(e instanceof o||(e=new o);x--;)switch(r=v[++b],s=r[0]){case".":w=[w[0][0],w[0][1].link(w[1])];break;case"?":w=[w[0],w[1].split()];break;case"+":w=[w[0],w[1].repeat()];break;case"*":w=[w[0],w[1].split(!0)];break;case"^,":case",":case"|":w=[w[0][0],w[0][1].merge(w[1],"^,"===s)];break;case"^-":case"-":w=[w[0][0],w[0][1].fill(w[1],"^-"===s)];break;case"$$":if(!w||null!==w[0])throw console.warn(w),new Error("Invalid end of expression. "+k);if(l=w[1],f=new p(O,null),l.link(f),g=m.id,(h=f.state.id)===g)throw new Error("Patterns resulting to empty token is not allowed. "+k);for(j[y++]=h,u=l.splitted;u;u=u.next){if((h=u.fragment.state.id)===g)throw console.log(n.source),new Error("Patterns resulting to empty token is not allowed. "+k);j[y++]=h}break;case"^":case"$":case"char":case"negative_char":l=new p(O,new d(r[1],"negative_char"===s)),m||(m=l.applyState()),w=[w,l]}return y&&e.finalizeFragments(t,w[1],j),O=w=u=l=f=null,e}var i=e(16),o=e(8),a=e(15),c=e(17);t.exports=r},function(t,n,e){"use strict";function r(t,n){var e,r,i=t+1,o=i+1,s=u,l=n.substring(i,o);switch(l){case"x":return r=i+2,e=n.substring(++i,r+1).match(a),e?[String.fromCharCode(parseInt(e[0],16)),r]:["x",o];case"u":return r=i+4,e=n.substring(++i,r+1).match(c),e?[String.fromCharCode(parseInt(e[0],16)),r]:["x",o];default:return[l in s?s[l]:l,o]}}function i(t,n){for(var e,r=t,i=n.length;i--;)if("}"===(e=n.charAt(++r))&&(e=n.substring(t+1,r),s.test(e)))return[e,r+1];return null}function o(t,n){var e,o,a,c=Math,s=n.length;if((t=c.max(0,t))>s)return null;if(t===s)return["$$",null,s+1];switch(o=t+1,e=n.charAt(t),a="char",e){case"\\":e=r(t,n),o=e[1],e=e[0],a="char";break;case"{":if(!(e=i(t,n)))throw new Error("Invalid token near "+n.substring(t,c.min(s,t+10)));o=e[1],e=e[0],a="range";break;case"[":if(o<s&&"^"===n.charAt(o)){a="[^",o++;break}case"]":case"(":case")":case"|":case"?":case"+":case"*":case"-":case"^":case"$":a=e}return a?[a,e,o]:null}var a=/^[a-fA-F0-9]{2}$/,c=/^[a-fA-F0-9]{4}$/,s=/^([0-9]+|[0-9]+\,[0-9]*|[0-9]*\,[0-9]+)$/,u={b:"\b",f:"\f",n:"\n",r:"\r",t:"\t",v:"\v","\\":"\\",B:"\\"};t.exports=o},function(t,n,e){"use strict";function r(){this.map=new o}var i=e(2),o=e(8),a=e(18);r.prototype={map:null,constructor:r,define:function(t){var n,e,r,o=i,c=o.string,s=o.regex,u=this.map,l=a,f=null;if(!o.array(t))throw new Error("Invalid definitions parameter.");for(e=-1,r=t.length;r--;)if(n=t[++e],c(n))f=n;else if(s(n)){if(n=n.source,!f)throw new Error("Token is not named "+n);l(f,n,u)}return this},fromJSON:function(t){return this.map.importDefinition(t),this},toJSON:function(){return JSON.stringify(this.toObject())},toObject:function(){return this.map.exportDefinition()},tokenize:function(t,n){var e,r,i,o,a,c,s,u,l,f,h=this.map,g=h.ends,p=h.states,d=[h.start,null],v=n.length,b=v-t,x=t-1,w=null;if(0===b)return["$","",v+1];if(b<1)return null;for(;b--;){for(e=n.charAt(++x),o=null;d;d=d[1]){if(c=d[0],s=p[c],c in g&&(w=[g[c],x]),e in s)for(a=s[e],r=-1,i=a.length;i--;)u=a[++r],o=[u,o],u in g&&(w=[g[u],x+1]);for(l=s.not,r=-1,i=l.length;i--;)u=l[++r],f=u[1],e in f||(u=u[0],o=[u,o],u in g&&(w=[g[u],x+1]))}if(!o)break;d=o}return w&&(x=w[1],console.log("what? ",w," index ",x," from: ",t),t===x?w=null:(w[2]=x,w[1]=n.substring(t,x))),w}},t.exports=r},function(t,n,e){t.exports=e(9)}])});